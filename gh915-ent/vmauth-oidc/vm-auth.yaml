# vm-auth.yaml
oidc:
  realms:
    - name: master
      issuer_url: http://keycloak:3001/realms/master
      # It's recommended to enable discovery in production
      skip_discovery: true
  claims:
    client_id: azp
users:
  - client:
      client_id: grafana
      realm: master
    url_map:
      - src_paths:
          - "/insert/.*"
        drop_src_path_prefix_parts: 1
        url_prefix: "http://vminsert:8480/insert/{{tenantID}}/prometheus/"
      - src_paths:
          - "/select/.*"
        drop_src_path_prefix_parts: 1
        url_prefix: "http://vmselect:8481/select/{{tenantID}}/prometheus/"
      - src_paths:
          - "/single/.*"
        drop_src_path_prefix_parts: 1
        url_prefix: "http://vmsingle:8428?extra_label={{vm_extra_label}}"